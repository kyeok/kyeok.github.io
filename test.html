<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width">

    <meta property="al:ios:url" content="https://gift-talk.kakao.com/appredirect?pepero2015=true&input_channel_id=487" />
    <meta property="al:ios:app_store_id" content="362057947"/>
    <meta property="al:ios:app_name" content="카카오톡"/>
    <meta property="al:android:url" content="https://gift-talk.kakao.com/appredirect?pepero2015=true&input_channel_id=487">
    <meta property="al:android:package" content="com.kakao.talk"/>
    <meta property="al:android:app_name" content="카카오톡"/>
    <meta property="al:web:should_fallback" content="false"/>

    <meta property="og:title" content="카카오톡선물하기"/>
    <meta property="og:image" content="http://img-gift.talk.kakao.co.kr/public/images/stamp/kakaotalk-gift.png"/>

    <!--
    <link rel="stylesheet" media="screen" href="/public/stylesheets/gift.css?v=20140228">
    -->

    <script type="text/javascript" charset="utf-8">
        var uagent = navigator.userAgent.toLocaleLowerCase();
        var andInstallUrl = "https://play.google.com/store/apps/details?id=com.kakao.talk";
        var iosInstallUrl = "http://itunes.apple.com/kr/app/id362057947";
        var appLoc = "http://www.kakaocorp.com/main";
        //var userAgent = "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.106 Safari/537.36";
        var talkClientVersion = "5.2.2";
        var loadedAt = +new Date;
        function redirect() {
            if (uagent.indexOf("android") >= 0) {
                if (get_browser() === 'chrome' && get_chrome_version().split('.')[0] >= 18) {
                    var strs = appLoc.split(":\/\/");
                    location = "intent://" + strs[1] + "#Intent;scheme=" + strs[0] + ";package=com.kakao.talk;end";
                } else {
                    var element = document.createElement('iframe');
                    element.id = '_install_frame_' + (new Date()).getTime();
                    document.getElementById('android_iframe_div').appendChild(element);
                    var r = document.getElementById(element.id);
                    var u = true;
                    window.addEventListener("pagehide", function () {
                        u = false;
                    }, false);
                    if (r != null) {
                        r.src = appLoc;
                    }
                    setTimeout(function () {
                        if (u) {
                            window.location = andInstallUrl;
                        }
                    }, 5000);
                }
            } else {
//
//                if( talkClientVersion == "0.0.0") {
//                    setTimeout(function () {
//                        if ((+new Date - loadedAt < 2000) && !document.webkitHidden) {
//                            install();
//                        }
//                    }, 1000);
//                }
                document.location = appLoc;
                if (!isInWeb()) {
                    setTimeout(function () {
                        if ((+new Date - loadedAt < 2000) && !document.webkitHidden) {
                            install();
                        }
                    }, 1000);
                }
            }
        }
        function isInWeb() {
            return !(talkClientVersion == "0.0.0" || talkClientVersion == null);
        }
        function install() {
            if (uagent.indexOf("android") >= 0) {
                location = andInstallUrl;
            } else {
                document.location = iosInstallUrl;
            }
        }
        function get_browser() {
            var N = navigator.appName, ua = navigator.userAgent.toLocaleLowerCase(), tem;
            var M = ua.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);
            if (M && (tem = ua.match(/version\/([\.\d]+)/i)) != null) M[2] = tem[1];
            M = M ? [M[1], M[2]] : [N, navigator.appVersion, '-?'];
            return M[0];
        }
        function get_chrome_version() {
            var N = navigator.appName, ua = navigator.userAgent.toLocaleLowerCase(), tem;
            var M = ua.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);
            if (M && (tem = ua.match(/chrome\/([\.\d]+)/i)) != null) M[2] = tem[1];
            M = M ? [M[1], M[2]] : [N, navigator.appVersion, '-?'];
            return M[1];
        }
    </script>
</head>

<body style="background: #ffffff;" onLoad="redirect();">
<div style="margin-top:40px; font-size:18pt; color:#e5310e; text-align:center">
    <span id="connecting_message">연결중입니다.</span>
</div>
<div style="margin-top:16px; text-align:center;">
    <img src="/public/images/share/img_gotokakao2.png" width="160">
</div>
<div style="margin-top:80px; font-size:12px; color:#a0a0a0; line-height:18px; text-align:center">
    카카오톡이 설치되어 있지 않으시거나<br/>최신버전이 아닌 경우 연결이 되지 않습니다.
</div>
<div style="margin-top:5px; font-size:12px; color:#a0a0a0; line-height:18px; text-align:center">
    <a href="javascript:install();" style="color:#606060; text-decoration:underline;">카카오톡 최신버전 설치하기</a>
</div>
<div style="text-align:center; margin-top:15px;">
    <button type="button" class="css3button" onclick="redirect();">카카오톡에서 확인</button>
</div>
<div id="android_iframe_div" style="display:none;">
</div>
<iframe id="hiddenIframe" style="display: none;"></iframe>
</body>
</html>

